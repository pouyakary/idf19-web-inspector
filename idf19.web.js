(()=>{"use strict";var e={477:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.computeConstructionMaterialLayerProfiles=n.analyzeConstructionLayers=void 0;const a=t(462),r=-1/0;function o(e){const n=e.length,t=new Array(n);for(let s=0;s<n;s++){const c=(r=e[s],o=s,"material"===r.type?function(e,n){const t=parseFloat(e.readFromRow(a.IDFConstants.MaterialIndices.THICKNESS)),r=parseFloat(e.readFromRow(a.IDFConstants.MaterialIndices.DENSITY)),o=parseFloat(e.readFromRow(a.IDFConstants.MaterialIndices.CONDUCTIVITY)),s=i(t/o),c=i(t*r);return{resistance:s,mass:c,index:n}}(r,o):function(e,n){const t=i(parseFloat(e.readFromRow(a.IDFConstants.MaterialWithoutMassIndices.THERMAL_RESISTANCE)));return{resistance:t,mass:0,index:n}}(r,o));t[n-s-1]=c}var r,o;return t}function i(e){return Math.round(1e5*e)/1e5}n.analyzeConstructionLayers=function(e,n){const t=o(e.layers);let a=r,i=r,s=r,c=r;for(const e of t)e.mass>i&&(i=e.mass,a=e.index),e.resistance>c&&(c=e.resistance,s=e.index);let l=-1/0;for(let e=a;e>0;e--)if(e!==s){const n=t[e];n.mass>.8*i&&(l=n.index)}let u=!1;l!==r&&(u=a>s&&l<s||a<s&&l>s);const d=`Layer Analysis for Construction "${e.accessor.name}"`;return n.appendTable(d,"#C3FF9C",(()=>function(e,n,t,a,r,o){const i=[],s=[],c=[],l=[],u=[];for(const d of e){const e=n.layers[d.index];i.push(`Original Index: ${d.index}`),c.push("material"===e.type?"Type: Material":"Type: Material Without Mass"),s.push(`Name: "${e.name}"`),l.push(`Mass: ${d.mass} (Kg/m²)\nResistance: ${d.resistance} (m²K/W)`);let m=[];d.index==t&&m.push("▶︎ Main Mass Layer"),d.index==r&&(m.push("▶︎ Thermal Resistance Layer"),o&&m.push("(in middle position)")),d.index==a&&m.push("▶︎ Secondary Mass Layer"),u.push(m.join("\n"))}return[i,c,s,l,u]}(t,e,a,l,s,u))),{indexOfMainMassLayer:a,indexOfThermalResistanceLayer:s,indexOfTheSecondaryMassLayer:l,resistanceLayerIsInTheMiddlePosition:u}},n.computeConstructionMaterialLayerProfiles=o},644:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.computeWhatToChangeInResistanceLayerToMatchReferenceExpectation=void 0;const a=t(462),r=t(477),o=1e6;n.computeWhatToChangeInResistanceLayerToMatchReferenceExpectation=function(e,n,t){const i=t-function(e,n){let t=0;const a=r.computeConstructionMaterialLayerProfiles(e.layers);for(const e of a)e.index!==n&&(t+=e.resistance);return t}(e,n),s=e.layers[n];if("material"===s.type){const e=(c=s.readFromRowAsNumber(a.IDFConstants.MaterialIndices.THICKNESS)/i,Math.ceil(c*o)/o);return e>1e-6?{propertyToChange:"conductivity",newValue:e}:{propertyToChange:"thickness",newValue:.01}}return{propertyToChange:"resistance",newValue:i};var c}},734:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.queryWallAdjacencyAction=n.FloorAndCeilingRAction=n.WallRAction=void 0;const a=t(462);var r,o;!function(e){e.ApplyOutdoorsR="Apply Outdoors R",e.ApplyUnconditionedR="Apply Unconditioned R",e.Skip="Skip"}(r=n.WallRAction||(n.WallRAction={})),(o=n.FloorAndCeilingRAction||(n.FloorAndCeilingRAction={})).ApplyOutdoorsR="Apply Outdoors R",o.Skip="Skip";const{SURFACE:i,GROUND:s,OUTDOORS:c}=a.IDFConstants.SurfaceBoundaryConditions;n.queryWallAdjacencyAction=function(e,n,t,o){const s=t.readFromRow(a.IDFConstants.SurfaceIndices.BOUNDARY_CONDITION);let l=!1,u=!1;s===i&&(u=!0,l=function(e,n){for(const[t,a]of e.zones)if(a.surfaces.has(n))return a;throw new Error("Could not find zone")}(o,t.readFromRow(a.IDFConstants.SurfaceIndices.BOUNDARY_CONDITION_OBJECT)).conditioned);const d=function(e,n,t){if(e){if(n==c)return r.ApplyOutdoorsR;if(n==i&&0==t)return r.ApplyUnconditionedR}else if(n==i&&1==t)return r.ApplyUnconditionedR;return r.Skip}(n,s,l);return function(e,n,t,a,r,o,i,s){s.appendTable(`Action Query for Surface "${n}"`,"#B9CBFF",(()=>{const e=[["Surface Type","Boundary Condition","Parent Zone"],["Floor",t,a?"Conditioned":"Unconditioned"]];return r&&(e[0].push("Adjacent Surface Zone"),e[1].push(o?"Conditioned":"Unconditioned")),e[0].push("Decision"),e[1].push(i.toUpperCase()),e}))}(0,t.name,s,n,u,l,d,e),d}},911:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.querySurfaceInsulationType=void 0;const a=t(734),r=t(477);n.querySurfaceInsulationType=function(e,n,t){if(e===a.WallRAction.ApplyUnconditionedR)return{insulationType:"Unconditioned",indexOfThermalResistanceLayer:0};const o=r.analyzeConstructionLayers(n,t),i=function(e,n,t){return e===a.WallRAction.ApplyUnconditionedR?"Unconditioned":1===new Set(n.layers.map((e=>e.name))).size?"Homogenous":t.resistanceLayerIsInTheMiddlePosition?"Intermediate":t.indexOfMainMassLayer<t.indexOfThermalResistanceLayer?"External":"Internal"}(e,n,o),{indexOfThermalResistanceLayer:s}=o;return t.appendText(`Queried Insulation Type: ${i}`),{insulationType:i,indexOfThermalResistanceLayer:s}}},66:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.computeWindowDirection=void 0;const a=t(639);function r(e){return 0===e.i?0===e.j?"0":e.j.toString()+"j":0===e.j?e.i.toString()+"i":`${e.i}i + ${e.j}j`}n.computeWindowDirection=function(e,n,t){const o=a.computeWindowNormal(e),i=function(e,n){const t=function(e){if(e.i>-1e-4&&e.i<1e-4)return e.j>0?90:270;const n=180*Math.atan(e.j/e.i)/Math.PI;return e.j<0?n:n+180}(e)+n;return t>360?t-360:t}(o,n.northAxis);let s="West";return(315<i&&i<360||0<i&&i<45)&&(s="East"),225<i&&i<315?s="South":45<i&&i<135&&(s="North"),t.appendTable(`Computing Direction of window "${e.name}"`,"#FFC39C",(()=>[["Computed Window Normal","Computed Alpha","Computed Direction"],[r(o),i.toString(),s]])),s}},639:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.computeWindowNormal=void 0;const a=t(462);n.computeWindowNormal=function(e){const n=e.readFromRowAsNumber(a.IDFConstants.FenestrationSurface_Detailed.VERTEX_1_X),t=e.readFromRowAsNumber(a.IDFConstants.FenestrationSurface_Detailed.VERTEX_1_Y),r=e.readFromRowAsNumber(a.IDFConstants.FenestrationSurface_Detailed.VERTEX_1_Z),o=e.readFromRowAsNumber(a.IDFConstants.FenestrationSurface_Detailed.VERTEX_2_X),i=e.readFromRowAsNumber(a.IDFConstants.FenestrationSurface_Detailed.VERTEX_2_Y),s=e.readFromRowAsNumber(a.IDFConstants.FenestrationSurface_Detailed.VERTEX_2_Z),c=e.readFromRowAsNumber(a.IDFConstants.FenestrationSurface_Detailed.VERTEX_3_X),l=e.readFromRowAsNumber(a.IDFConstants.FenestrationSurface_Detailed.VERTEX_3_Y),u=e.readFromRowAsNumber(a.IDFConstants.FenestrationSurface_Detailed.VERTEX_3_Z);return e.readFromRowAsNumber(a.IDFConstants.FenestrationSurface_Detailed.VERTEX_4_X),e.readFromRowAsNumber(a.IDFConstants.FenestrationSurface_Detailed.VERTEX_4_Y),e.readFromRowAsNumber(a.IDFConstants.FenestrationSurface_Detailed.VERTEX_4_Z),{i:(l-i)*(r-s)-(t-i)*(u-s),j:(n-o)*(u-s)-(c-o)*(r-s)}}},850:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getWindowTemplateName=void 0,n.getWindowTemplateName=function(e,n){return`IDF19_TEMPLATE_WINDOW_G${e.group}_${"Heating"===e.energyNeed?"H":"C"}_${"North"===n?"N":"South"===n?"S":"E"}_${"EC"===e.ec?"EC":"EC+"===e.ec?"ECP":"ECPP"}`}},625:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createFastAccessMap=n.compileToReferenceIDF=void 0;const a=t(462),r=t(812),o=t(363),i=t(998),s=t(59),c=t(465);function l(...e){const n=new Map;for(const t of e)for(const e of t)n.set(e.name,e);return n}n.compileToReferenceIDF=function(e,n,t){t.markSection("Preparation for Compilation");const{queriedSurfaces:u,queriedFenestrationSurfaces:d,queriedConstructions:m,queriedMaterials:f,queriedMaterialsWithoutMass:_,queriedZones:E,queriedConditionedZones:T,queriedHVACTemplateZoneIdealLoadsAirSystems:p,queriedBuilding:I}=e.queryEntriesByTypesGrouped(t,{Building:"queriedBuilding","BuildingSurface:Detailed":"queriedSurfaces","FenestrationSurface:Detailed":"queriedFenestrationSurfaces",Construction:"queriedConstructions",Material:"queriedMaterials","Material:NoMass":"queriedMaterialsWithoutMass",Zone:"queriedZones","ZoneControl:Thermostat":"queriedConditionedZones","HVACTemplate:Zone:IdealLoadsAirSystem":"queriedHVACTemplateZoneIdealLoadsAirSystems"}),C=l(m),h=l(f,_),g=r.createTheModel(C,h,I,E,u,d,T,p,t),{cachedFloorsAndCeilings:S,surfaceWallLayeringCounts:F}=function(e,n,t,r){n.markSection("First Surface Computation/Transformation Stage"),n.appendText("Computing and performing transformation on the walls and caching floors / ceiling");const i=new Array,s={outdoors:0,other:0,none:0};for(const[l,u]of e.zones)if(u.conditioned)for(const[l,d]of u.surfaces){n.appendLine();const m=d.accessor.readFromRow(a.IDFConstants.SurfaceIndices.TYPE);switch(n.appendText(`Surface Name: ${l}\n\nSurface Type: ${m}`),m){case"Wall":s[o.transformWall(u,d,t,e,r,n)]++;break;case"Floor":case"Roof":case"Ceiling":i.push([d,u])}for(const[a,o]of d.windows)n.appendText(`> Evaluating Surface Window "${a}"`),c.transformWindow(o,e,t,r,n)}return{cachedFloorsAndCeilings:i,surfaceWallLayeringCounts:s}}(g,t,e,n);!function(e,n,t,r,o,s){r.markSection("Second Surface Computation/Transformation Stage"),r.appendText("Computing the cached Floors and Ceilings ");const c=n.outdoors>n.other;for(const[n,l]of e){const e=n.accessor.readFromRow(a.IDFConstants.SurfaceIndices.TYPE);r.appendLine(),r.appendText(`Surface Name: ${n.accessor.name}\n\nSurface Type: ${e}`),i.transformFloorAndCeiling(l,n,o,t,s,c,r)}}(S,F,g,t,e,n),n.removeGlazing&&s.removeShadingsFromDocument(e)},n.createFastAccessMap=l},812:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createTheModel=void 0;const a=t(462);n.createTheModel=function(e,n,t,r,o,i,s,c,l){l.markSection("Making the Model");const u=new Map,d=[];for(const e of r)d.push(e.name),u.set(e.name,{conditioned:!1,surfaces:new Map});for(const t of o){const r=t.readFromRow(a.IDFConstants.SurfaceIndices.ZONE),o=e.get(t.readFromRow(a.IDFConstants.SurfaceIndices.CONSTRICTION)),s={accessor:o,layers:[]};let c=!0;for(const e of o.values())c?c=!1:s.layers.push(n.get(e));const l=new Map;for(const n of i){const r=n.readFromRow(a.IDFConstants.FenestrationSurface_Detailed.SURFACE_NAME);if(t.name===r){const t={accessor:e.get(n.readFromRow(a.IDFConstants.SurfaceIndices.CONSTRICTION)),layers:[]};l.set(n.name,{accessor:n,construction:t})}}u.get(r).surfaces.set(t.name,{accessor:t,construction:s,windows:l})}for(const e of s){const n=e.readFromRow(a.IDFConstants.ZoneControlThermostat.ZONE);u.get(n).conditioned=!0}for(const e of c){const n=e.readFromRow(a.IDFConstants.HVACTemplateZoneIdealLoadsAirSystemIndices.ZONE_NAME);""!==e.readFromRow(a.IDFConstants.HVACTemplateZoneIdealLoadsAirSystemIndices.THERMOSTAT_NAME)&&(u.get(n).conditioned=!0)}l.appendTable("Model","#A5A1FF",(()=>{const e=new Array;for(const n of d)for(const[t,a]of u.get(n).surfaces){e.push(t.length);for(const[n]of a.windows)e.push(n.length+3)}const n="─".repeat(Math.max(...e)+3+2),t="&nbsp;".repeat(3);return[["ZONE NAME","CONDITION STATUS","ZONE SURFACES"],...d.map((e=>{const a=u.get(e);return[e,a.conditioned?"Conditioned":"Unconditioned",Array.from(a.surfaces.keys()).map((e=>`• ${e}`+Array.from(a.surfaces.get(e).windows.keys()).map(((e,n)=>`\n${t}▶︎ ${e}`)).join(""))).join("\n"+n+"\n")]}))]}));let m=0;return 1===t.length&&(m=t[0].readFromRowAsNumber(a.IDFConstants.Building.NORTH_AXIS)),{zones:u,northAxis:m}}},998:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.transformFloorAndCeiling=void 0;const a=t(462),r=t(734),o=t(911),i=t(466),s=t(641);n.transformFloorAndCeiling=function(e,n,t,c,l,u,d){const m=r.queryWallAdjacencyAction(d,e.conditioned,n.accessor,c);if(m===r.WallRAction.Skip)return;const{insulationType:f,indexOfThermalResistanceLayer:_}=o.querySurfaceInsulationType(m,n.construction,d),E=(n.accessor.readFromRow(a.IDFConstants.SurfaceIndices.TYPE)===a.IDFConstants.SurfaceTypes.FLOOR?i.queryReferenceResistanceValuesForFloor:i.queryReferenceResistanceValuesForRoofAndCeiling)(f,u,l,d),T=s.sustituteConstructionWithANewConstructionOfReferenceResistanceOf(E,_,n,t,d);n.accessor.writeToRow(a.IDFConstants.SurfaceIndices.CONSTRICTION,T)}},641:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.sustituteConstructionWithANewConstructionOfReferenceResistanceOf=void 0;const a=t(462),r=t(644);n.sustituteConstructionWithANewConstructionOfReferenceResistanceOf=function(e,n,t,o,i){const s=t.construction,c=t.accessor.name,l=[],u=r.computeWhatToChangeInResistanceLayerToMatchReferenceExpectation(s,n,e),d=s.layers[n];l.push(["Type Of Thermal Resistance Layer",d.type]),l.push(["Index of Thermal Resistance Layer",n.toString()]),l.push(["What Property to change",u.propertyToChange]),l.push(["New value of the property",u.newValue.toString()]);let m="";switch(u.propertyToChange){case"conductivity":m=o.cloneObject(d,a.IDFConstants.MaterialIndices.CONDUCTIVITY,u.newValue);break;case"thickness":m=o.cloneObject(d,a.IDFConstants.MaterialIndices.THICKNESS,u.newValue);break;case"resistance":m=o.cloneObject(d,a.IDFConstants.MaterialWithoutMassIndices.THERMAL_RESISTANCE,u.newValue)}l.push(["Name of the original Material: ",d.name]),l.push(["Name of the new Material: ",m]);const f=o.cloneObject(s.accessor,n+1,m);return l.push(["Name of the original Construction: ",s.accessor.name]),l.push(["Name of the new Construction: ",f]),i.appendTable(`Material &amp; Construction Substitution for Surface "${c}"`,"#FFEF9D",(()=>l)),f}},59:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.removeShadingsFromDocument=void 0;const a=t(298);n.removeShadingsFromDocument=function(e){for(const n of a.LIST_OF_REMOVABLE_OBJECTS)e.excludeTypeFromOutputIDF(n)}},363:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.transformWall=void 0;const a=t(462),r=t(734),o=t(911),i=t(466),s=t(641);n.transformWall=function(e,n,t,c,l,u){const d=r.queryWallAdjacencyAction(u,e.conditioned,n.accessor,c);if(d===r.WallRAction.Skip)return"none";const{insulationType:m,indexOfThermalResistanceLayer:f}=o.querySurfaceInsulationType(d,n.construction,u),_=i.queryReferenceResistanceValuesForWall(m,l,u),E=s.sustituteConstructionWithANewConstructionOfReferenceResistanceOf(_,f,n,t,u);return n.accessor.writeToRow(a.IDFConstants.SurfaceIndices.CONSTRICTION,E),"External"===m?"outdoors":"other"}},465:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.transformWindow=void 0;const a=t(462),r=t(66),o=t(850);n.transformWindow=function(e,n,t,i,s){const c=[],l=r.computeWindowDirection(e.accessor,n,s),u=o.getWindowTemplateName(i,l);c.push(["Name of the template material: ",u]),c.push(["Name of the original Construction: ",e.construction.accessor.name]);const d=t.cloneObject(e.construction.accessor,2,u);c.push(["Name of the new Construction: ",d]),e.accessor.writeToRow(a.IDFConstants.FenestrationSurface_Detailed.CONSTRUCTION_ID,d),s.appendTable(`Material &amp; Construction Substitution for Window "${e.accessor.name}"`,"#FFEF9D",(()=>c))}},298:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.LIST_OF_REMOVABLE_OBJECTS=n.LIST_OF_GLAZING_TO_BE_SIMPLIFIED=void 0,n.LIST_OF_GLAZING_TO_BE_SIMPLIFIED=Object.freeze(["WindowMaterial:Glazing","WindtowMaterial:Glazing:Thermodynamic","WindowMaterial:Glazing:"]),n.LIST_OF_REMOVABLE_OBJECTS=Object.freeze(["WindowMaterial:Shade","WindowMaterial:ComplexShade","WindowMaterial:Blind","WindowMaterial:Screen","WindowMaterial:Shade:EquivalentLayer","WindowMaterial:Drape:EquivalentLayer","WindowMaterial:Blind:EquivalentLayer","WindowMaterial:Screen:EquivalentLayer"])},466:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.queryReferenceResistanceValuesForRoofAndCeiling=n.queryReferenceResistanceValuesForFloor=n.queryReferenceResistanceValuesForWall=void 0;const a=t(969);n.queryReferenceResistanceValuesForWall=function(e,n,t){const r=function(e,n){switch(n.group){case 1:switch(n.ec){case"EC":switch(e){case"External":return 1.2;case"Internal":case"Intermediate":return 2.3;case"Homogenous":return 2.1;case"Unconditioned":return 1}case"EC+":switch(e){case"External":return 1.7;case"Internal":case"Intermediate":return 3.3;case"Homogenous":return 3;case"Unconditioned":return 1.4}case"EC++":switch(e){case"External":return 2.4;case"Internal":case"Intermediate":case"Homogenous":throw new a.IDF19Error("idf",`For EC++ Type 1 Building only external insulation is authorized. (Found insulation: "${e}")`);case"Unconditioned":return 2}}case 2:switch(n.ec){case"EC":switch(e){case"External":return.9;case"Internal":case"Intermediate":return 1.5;case"Homogenous":return 1.4;case"Unconditioned":return.8}case"EC+":switch(e){case"External":return 1.3;case"Internal":case"Intermediate":return 2.1;case"Homogenous":return 2;case"Unconditioned":return 1.1}case"EC++":switch(e){case"External":return 1.8;case"Internal":case"Intermediate":return 3;case"Homogenous":return 2.8;case"Unconditioned":return 1.6}}case 3:switch(n.ec){case"EC":switch(e){case"External":return.8;case"Internal":case"Intermediate":return 1.2;case"Homogenous":return 1.1;case"Unconditioned":return.7}case"EC+":switch(e){case"External":return 1.1;case"Internal":case"Intermediate":return 1.7;case"Homogenous":return 1.6;case"Unconditioned":return 1}case"EC++":switch(e){case"External":return 1.6;case"Internal":case"Intermediate":return 2.4;case"Homogenous":return 2.2;case"Unconditioned":return 1.2}}}}(e,n);return t.appendTable("Expected Wall Resistance Query","#FF9AFF",(()=>[["Insulation\nType","Building\nGroup","Code 19 Energy\nCompliance","Queried Expected\nResistance"],[e,n.group.toString(),n.ec,`${r} (m²K/W)`]])),r},n.queryReferenceResistanceValuesForFloor=function(e,n,t,r){const o=function(e,n,t){if(n)switch(t.group){case 1:switch(t.ec){case"EC":switch(e){case"External":return 2.3;case"Internal":case"Intermediate":case"Homogenous":return 3;case"Unconditioned":return 1}case"EC+":switch(e){case"External":return 3.3;case"Internal":case"Intermediate":case"Homogenous":return 4.3;case"Unconditioned":return 1.4}case"EC++":switch(e){case"External":return 4.6;case"Internal":case"Intermediate":case"Homogenous":throw new a.IDF19Error("idf",`For EC++ Type 1 Building only external insulation is authorized. (Found insulation: "${e}")`);case"Unconditioned":return 2}}case 2:switch(t.ec){case"EC":switch(e){case"External":return 1.8;case"Internal":case"Intermediate":case"Homogenous":return 2.2;case"Unconditioned":return.8}case"EC+":switch(e){case"External":return 2.6;case"Internal":case"Intermediate":case"Homogenous":return 3.1;case"Unconditioned":return 1.1}case"EC++":switch(e){case"External":return 3.6;case"Internal":case"Intermediate":case"Homogenous":return 4.4;case"Unconditioned":return 1.6}}case 3:switch(t.ec){case"EC":switch(e){case"External":return 1.6;case"Internal":case"Intermediate":case"Homogenous":return 1.9;case"Unconditioned":return.7}case"EC+":switch(e){case"External":return 2.3;case"Internal":case"Intermediate":case"Homogenous":return 2.7;case"Unconditioned":return 1}case"EC++":switch(e){case"External":return 3.2;case"Internal":case"Intermediate":case"Homogenous":return 3.8;case"Unconditioned":return 1.4}}}else switch(t.group){case 1:switch(t.ec){case"EC":switch(e){case"External":return 3.3;case"Internal":case"Intermediate":case"Homogenous":return 2.3;case"Unconditioned":return 1}case"EC+":switch(e){case"External":return 4.7;case"Internal":case"Intermediate":case"Homogenous":return 3.3;case"Unconditioned":return 1.4}case"EC++":switch(e){case"External":case"Internal":case"Intermediate":case"Homogenous":throw new a.IDF19Error("idf",`For EC++ Type 1 Building only external insulation is authorized. (Found insulation: "${e}")`);case"Unconditioned":return 2}}case 2:switch(t.ec){case"EC":switch(e){case"External":return 2.4;case"Internal":case"Intermediate":case"Homogenous":return 1.8;case"Unconditioned":return.8}case"EC+":switch(e){case"External":return 3.4;case"Internal":case"Intermediate":case"Homogenous":return 2.6;case"Unconditioned":return 1.1}case"EC++":switch(e){case"External":return 4.8;case"Internal":case"Intermediate":case"Homogenous":return 3.6;case"Unconditioned":return 1.6}}case 3:switch(t.ec){case"EC":switch(e){case"External":return 2;case"Internal":case"Intermediate":case"Homogenous":return 1.6;case"Unconditioned":return.7}case"EC+":switch(e){case"External":return 2.9;case"Internal":case"Intermediate":case"Homogenous":return 2.3;case"Unconditioned":return 1}case"EC++":switch(e){case"External":return 4;case"Internal":case"Intermediate":case"Homogenous":return 3.2;case"Unconditioned":return 1.4}}}}(e,n,t);return r.appendTable("Expected Floor Resistance Query","#FF9AFF",(()=>[["Insulation\nType","Average Building Walls\nResistance Layers","Building\nGroup","Code 19 Energy\nCompliance","Queried Expected\nResistance"],[e,n?"Outdoors":"Other",t.group.toString(),t.ec,`${o} (m²K/W)`]])),o},n.queryReferenceResistanceValuesForRoofAndCeiling=function(e,n,t,r){const o=function(e,n,t){if(n)switch(t.group){case 1:switch(t.ec){case"EC":switch(e){case"External":return 2.2;case"Internal":case"Intermediate":case"Homogenous":return 3.2;case"Unconditioned":return 1.9}case"EC+":switch(e){case"External":return 3.1;case"Internal":case"Intermediate":case"Homogenous":return 4.6;case"Unconditioned":return 1.3}case"EC++":switch(e){case"External":return 4.4;case"Internal":case"Intermediate":case"Homogenous":throw new a.IDF19Error("idf",`For EC++ Type 1 Building only external insulation is authorized. (Found insulation: "${e}")`);case"Unconditioned":return 1.8}}case 2:switch(t.ec){case"EC":switch(e){case"External":return 1.6;case"Internal":case"Intermediate":case"Homogenous":return 2.3;case"Unconditioned":return.7}case"EC+":switch(e){case"External":return 2.3;case"Internal":case"Intermediate":case"Homogenous":return 3.3;case"Unconditioned":return 1}case"EC++":switch(e){case"External":return 3.2;case"Internal":case"Intermediate":case"Homogenous":return 4.6;case"Unconditioned":return 1.4}}case 3:switch(t.ec){case"EC":switch(e){case"External":return 1.4;case"Internal":case"Intermediate":case"Homogenous":return 1.9;case"Unconditioned":return.6}case"EC+":switch(e){case"External":return 2;case"Internal":case"Intermediate":case"Homogenous":return 2.7;case"Unconditioned":return.9}case"EC++":switch(e){case"External":return 2.8;case"Internal":case"Intermediate":case"Homogenous":return 3.8;case"Unconditioned":return 1.2}}}else switch(t.group){case 1:switch(t.ec){case"EC":switch(e){case"External":return 3.5;case"Internal":case"Intermediate":case"Homogenous":return 2.3;case"Unconditioned":return.9}case"EC+":switch(e){case"External":return 5;case"Internal":case"Intermediate":case"Homogenous":return 3.3;case"Unconditioned":return 1.3}case"EC++":switch(e){case"External":case"Internal":case"Intermediate":case"Homogenous":throw new a.IDF19Error("idf",`For EC++ Type 1 Building only external insulation is authorized. (Found insulation: "${e}")`);case"Unconditioned":return 1.8}}case 2:switch(t.ec){case"EC":switch(e){case"External":return 2.5;case"Internal":case"Intermediate":case"Homogenous":return 1.7;case"Unconditioned":return.7}case"EC+":switch(e){case"External":return 3.5;case"Internal":case"Intermediate":case"Homogenous":return 2.4;case"Unconditioned":return 1}case"EC++":switch(e){case"External":return 5;case"Internal":case"Intermediate":case"Homogenous":return 3.4;case"Unconditioned":return 1.4}}case 3:switch(t.ec){case"EC":switch(e){case"External":return 2;case"Internal":case"Intermediate":case"Homogenous":return 1.5;case"Unconditioned":return.6}case"EC+":switch(e){case"External":return 2.9;case"Internal":case"Intermediate":case"Homogenous":return 2.1;case"Unconditioned":return.9}case"EC++":switch(e){case"External":return 4;case"Internal":case"Intermediate":case"Homogenous":return 3;case"Unconditioned":return 1.2}}}}(e,n,t);return r.appendTable("Expected Ceiling Resistance Query","#FF9AFF",(()=>[["Insulation\nType","Average Building Walls\nResistance Layers","Building\nGroup","Code 19 Energy\nCompliance","Queried Expected\nResistance"],[e,n?"Outdoors":"Other",t.group.toString(),t.ec,`${o} (m²K/W)`]])),o}},586:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CHAPTER19_WINDOW_TEMPLATE_MATERIALS=void 0,n.CHAPTER19_WINDOW_TEMPLATE_MATERIALS="\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_H_S_EC,  !- Name\n    3.100,                   !- U-Factor {W/m2-K}\n    0.600,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_H_S_ECP,  !- Name\n    2.200,                   !- U-Factor {W/m2-K}\n    0.630,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_H_S_ECPP,  !- Name\n    1.800,                   !- U-Factor {W/m2-K}\n    0.650,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_H_N_EC,  !- Name\n    3.100,                   !- U-Factor {W/m2-K}\n    0.760,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_H_N_ECP,  !- Name\n    2.200,                   !- U-Factor {W/m2-K}\n    0.760,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_H_N_ECPP,  !- Name\n    1.800,                   !- U-Factor {W/m2-K}\n    0.760,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_H_E_EC,  !- Name\n    3.100,                   !- U-Factor {W/m2-K}\n    0.500,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_H_E_ECP,  !- Name\n    2.200,                   !- U-Factor {W/m2-K}\n    0.530,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_H_E_ECPP,  !- Name\n    1.800,                   !- U-Factor {W/m2-K}\n    0.550,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_C_S_EC,  !- Name TTTTTTTTTTTTTTT\n    3.100,                   !- U-Factor {W/m2-K}\n    0.400,                   !- Solar Heat Gain Coefficient\n    0.480;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_C_S_ECP,  !- Name\n    2.400,                   !- U-Factor {W/m2-K}\n    0.370,                   !- Solar Heat Gain Coefficient\n    0.629;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_C_S_ECPP,  !- Name\n    2.200,                   !- U-Factor {W/m2-K}\n    0.350,                   !- Solar Heat Gain Coefficient\n    0.770;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_C_N_EC,  !- Name\n    3.100,                   !- U-Factor {W/m2-K}\n    0.500,                   !- Solar Heat Gain Coefficient\n    0.500;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_C_N_ECP,  !- Name\n    2.400,                   !- U-Factor {W/m2-K}\n    0.450,                   !- Solar Heat Gain Coefficient\n    0.630;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_C_N_ECPP,  !- Name\n    2.200,                   !- U-Factor {W/m2-K}\n    0.400,                   !- Solar Heat Gain Coefficient\n    0.760;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_C_E_EC,  !- Name\n    3.100,                   !- U-Factor {W/m2-K}\n    0.350,                   !- Solar Heat Gain Coefficient\n    0.490;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_C_E_ECP,  !- Name\n    2.400,                   !- U-Factor {W/m2-K}\n    0.300,                   !- Solar Heat Gain Coefficient\n    0.600;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G1_C_E_ECPP,  !- Name\n    2.200,                   !- U-Factor {W/m2-K}\n    0.250,                   !- Solar Heat Gain Coefficient\n    0.700;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_H_S_EC,  !- Name TTTTTTTTTTTTTTT\n    3.100,                   !- U-Factor {W/m2-K}\n    0.600,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_H_S_ECP,  !- Name\n    2.600,                   !- U-Factor {W/m2-K}\n    0.570,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_H_S_ECPP,  !- Name\n    2.400,                   !- U-Factor {W/m2-K}\n    0.550,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_H_N_EC,  !- Name\n    3.100,                   !- U-Factor {W/m2-K}\n    0.760,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_H_N_ECP,  !- Name\n    2.600,                   !- U-Factor {W/m2-K}\n    0.760,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_H_N_ECPP,  !- Name\n    2.400,                   !- U-Factor {W/m2-K}\n    0.760,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_H_E_EC,  !- Name\n    3.100,                   !- U-Factor {W/m2-K}\n    0.500,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_H_E_ECP,  !- Name\n    2.600,                   !- U-Factor {W/m2-K}\n    0.470,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_H_E_ECPP,  !- Name\n    2.400,                   !- U-Factor {W/m2-K}\n    0.450,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_C_S_EC,  !- Name TTTTTTTTTTTTTTT\n    3.100,                   !- U-Factor {W/m2-K}\n    0.300,                   !- Solar Heat Gain Coefficient\n    0.330;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_C_S_ECP,  !- Name\n    2.600,                   !- U-Factor {W/m2-K}\n    0.330,                   !- Solar Heat Gain Coefficient\n    0.500;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_C_S_ECPP,  !- Name\n    2.400,                   !- U-Factor {W/m2-K}\n    0.350,                   !- Solar Heat Gain Coefficient\n    0.630;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_C_N_EC,  !- Name\n    3.100,                   !- U-Factor {W/m2-K}\n    0.730,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_C_N_ECP,  !- Name\n    2.400,                   !- U-Factor {W/m2-K}\n    0.540,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_C_N_ECPP,  !- Name\n    2.200,                   !- U-Factor {W/m2-K}\n    0.450,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_C_E_EC,  !- Name\n    3.100,                   !- U-Factor {W/m2-K}\n    0.250,                   !- Solar Heat Gain Coefficient\n    0.350;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_C_E_ECP,  !- Name\n    2.600,                   !- U-Factor {W/m2-K}\n    0.250,                   !- Solar Heat Gain Coefficient\n    0.425;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G2_C_E_ECPP,  !- Name\n    2.200,                   !- U-Factor {W/m2-K}\n    0.250,                   !- Solar Heat Gain Coefficient\n    0.500;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_H_S_EC,  !- Name TTTTTTTTTTTTTTT\n    3.100,                   !- U-Factor {W/m2-K}\n    0.650,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_H_S_ECP,  !- Name\n    2.800,                   !- U-Factor {W/m2-K}\n    0.620,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_H_S_ECPP,  !- Name\n    2.600,                   !- U-Factor {W/m2-K}\n    0.600,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_H_N_EC,  !- Name\n    3.100,                   !- U-Factor {W/m2-K}\n    0.760,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_H_N_ECP,  !- Name\n    2.800,                   !- U-Factor {W/m2-K}\n    0.760,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_H_N_ECPP,  !- Name\n    2.600,                   !- U-Factor {W/m2-K}\n    0.760,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_H_E_EC,  !- Name\n    3.100,                   !- U-Factor {W/m2-K}\n    0.550,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_H_E_ECP,  !- Name\n    2.800,                   !- U-Factor {W/m2-K}\n    0.520,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_H_E_ECPP,  !- Name\n    2.600,                   !- U-Factor {W/m2-K}\n    0.500,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_C_S_EC,  !- Name TTTTTTTTTTTTTTT\n    3.100,                   !- U-Factor {W/m2-K}\n    0.300,                   !- Solar Heat Gain Coefficient\n    0.330;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_C_S_ECP,  !- Name\n    2.800,                   !- U-Factor {W/m2-K}\n    0.330,                   !- Solar Heat Gain Coefficient\n    0.429;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_C_S_ECPP,  !- Name\n    2.600,                   !- U-Factor {W/m2-K}\n    0.350,                   !- Solar Heat Gain Coefficient\n    0.525;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_C_N_EC,  !- Name\n    3.100,                   !- U-Factor {W/m2-K}\n    0.740,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_C_N_ECP,  !- Name\n    2.800,                   !- U-Factor {W/m2-K}\n    0.620,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_C_N_ECPP,  !- Name\n    2.600,                   !- U-Factor {W/m2-K}\n    0.540,                   !- Solar Heat Gain Coefficient\n    0.810;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_C_E_EC,  !- Name\n    3.100,                   !- U-Factor {W/m2-K}\n    0.250,                   !- Solar Heat Gain Coefficient\n    0.400;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_C_E_ECP,  !- Name\n    2.800,                   !- U-Factor {W/m2-K}\n    0.250,                   !- Solar Heat Gain Coefficient\n    0.400;                   !- Visible Transmittance\n\nWindowMaterial:SimpleGlazingSystem,\n    IDF19_TEMPLATE_WINDOW_G3_C_E_ECPP,  !- Name\n    2.600,                   !- U-Factor {W/m2-K}\n    0.250,                   !- Solar Heat Gain Coefficient\n    0.450;\n"},969:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.IDF19Error=void 0;class t{#type;#message;constructor(e,n){this.#type=e,this.#message=n}static initWithAnyKindOfError(e){return e instanceof t?e:new t("runtime","string"==typeof e?e:e.message)}get origin(){return this.#type}get message(){return this.#message}}n.IDF19Error=t},345:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.IDFObjectAccessor=void 0,n.IDFObjectAccessor=class{entry;constructor(e){this.entry=e}readFromRowAsNumber(e){return parseFloat(this.readFromRow(e))}readFromRow(e){if(e>=0&&e<this.entry.length)return this.entry[e][0];throw this.createOutOfBoundaryError(e)}writeToRow(e,n){if(!(e>0&&e<this.entry.length))throw this.createOutOfBoundaryError(e);this.entry[e][0]=function(e){return"number"==typeof e?e.toString():"boolean"==typeof e?e?"Yes":"No":e}(n)}createOutOfBoundaryError(e){return new Error(`Object Row Access Error: Out of boundary. Requested ${e} in boundary of 0-${this.entry.length}.`)}get type(){return this.entry[0][0].toLowerCase()}get name(){return this.entry[1][0]}*values(){for(var e=1;e<this.entry.length;e++)yield this.readFromRow(e)}}},482:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FenestrationSurface_Detailed=n.ZoneControlThermostat=n.ZoneIndices=n.HVACTemplateZoneIdealLoadsAirSystemIndices=n.MaterialWithoutMassIndices=n.MaterialIndices=n.SurfaceTypes=n.SurfaceBoundaryConditions=n.SurfaceIndices=n.Building=void 0,n.Building=Object.freeze({NORTH_AXIS:2}),n.SurfaceIndices=Object.freeze({TYPE:2,CONSTRICTION:3,ZONE:4,BOUNDARY_CONDITION:5,BOUNDARY_CONDITION_OBJECT:6}),n.SurfaceBoundaryConditions=Object.freeze({SURFACE:"Surface",GROUND:"Ground",OUTDOORS:"Outdoors"}),n.SurfaceTypes=Object.freeze({CEILING:"Ceiling",FLOOR:"Floor",WALL:"Wall"}),n.MaterialIndices=Object.freeze({THICKNESS:3,CONDUCTIVITY:4,DENSITY:5}),n.MaterialWithoutMassIndices=Object.freeze({ROUGHNESS:2,THERMAL_RESISTANCE:3,THERMAL_ABSORPTANCE:4,SOLAR_ABSORPTANCE:5,VISIBLE_ABSORPTANCE:6}),n.HVACTemplateZoneIdealLoadsAirSystemIndices=Object.freeze({ZONE_NAME:1,THERMOSTAT_NAME:2}),n.ZoneIndices=Object.freeze({}),n.ZoneControlThermostat=Object.freeze({ZONE:2}),n.FenestrationSurface_Detailed=Object.freeze({CONSTRUCTION_ID:3,SURFACE_NAME:4,VERTEX_1_X:10,VERTEX_1_Y:11,VERTEX_1_Z:12,VERTEX_2_X:13,VERTEX_2_Y:14,VERTEX_2_Z:15,VERTEX_3_X:16,VERTEX_3_Y:17,VERTEX_3_Z:18,VERTEX_4_X:19,VERTEX_4_Y:20,VERTEX_4_Z:21})},73:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.IDFDocument=void 0;const a=t(713),r=t(345),o=t(506),i=t(586),s=t(943);class c{#originalObjects;#addedObjects;#accessors;#nameGenCounter;#logger;#excludeFromOutput;constructor(e,n){n.markSection("Paring Phase"),this.#originalObjects=a.parseIDF(e,n),this.#addedObjects=[],this.#accessors=new Map,this.#nameGenCounter=1,this.#excludeFromOutput=[],this.#logger=n,n.appendText(`Created the document with ${n.formatNumber(this.#originalObjects.length)} entries.`)}queryEntriesByTypesGrouped(e,n){const t=this.#originalObjects.length,a=Object.keys(n),r={};for(const e of a)r[n[e]]=[];const o=new Set;for(let e=0;e<t;e++){const t=this.#originalObjects[e][0][0];a.includes(t)&&(r[n[t]].push(this.getObjectAccessor(e)),o.add(t))}return e.appendTable("Document Query","#FF9AFF",(()=>Array.from(o).map((e=>[e,`as ${n[e]}`,`${r[n[e]].length} results.`])))),r}getObjectAccessor(e){return this.#accessors.get(e)||this.createAccessor(e)}createAccessor(e){const n=this.#originalObjects[e],t=new r.IDFObjectAccessor(n);return this.#accessors.set(e,t),t}get serializedIDF(){this.gatherBackTheChange();const e=o.serializeIDFDocument(this.#originalObjects,this.#excludeFromOutput),n=o.serializeIDFDocument(this.#addedObjects,[]);return e+o.GENERATED_IDF_OBJECTS_HEADER+n+o.C19_TEMPLATE_MATERIALS_HEADER+i.CHAPTER19_WINDOW_TEMPLATE_MATERIALS}gatherBackTheChange(){for(const[e,n]of this.#accessors)this.#originalObjects[e]=n.entry}get averageDocumentObjectSize(){let e=0;for(const n of this.#originalObjects)e+=n.length;return Math.floor(e/this.#originalObjects.length)}cloneObject(e,n,t){const a=c.serializeJSValue(t),r=e.entry,o=[],i=this.generateCloneName(e.type);for(let e=0;e<r.length;e++)1===e?o.push([i,r[e][1]]):e===n?o.push([a,r[e][1]]):o.push(r[e]);return this.#addedObjects.push(o),i}addObject(e){this.#addedObjects.push(e)}excludeTypeFromOutputIDF(e){this.#excludeFromOutput.push(e)}static serializeJSValue(e){return"number"==typeof e?e.toString():"boolean"==typeof e?e?"Yes":"No":e}get aNewCloneID(){return(this.#nameGenCounter++).toString()}generateCloneName(e){return`IDF19_${e.toUpperCase()}_ID_${this.aNewCloneID}`}garbageCollect(){this.#originalObjects=s.garbageCollectIDF(this.#logger,this.#originalObjects,this.#addedObjects)}}n.IDFDocument=c},943:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.garbageCollectIDF=void 0;const t=["Version"],a=["Construction","Material","Material:NoMass"];n.garbageCollectIDF=function(e,n,r){e.markSection("Garbage Collection");const o=function(e){const n=new Map;for(const t of e){const e=t[0][0];a.includes(e)&&n.set(t[1][0],{type:t[0][0],references:0})}return n}(n);!function(e,n){for(const a of n){const n=a[0][0];if(!t.includes(n))for(let n=2;n<a.length;n++){const t=a[n][0];e.has(t)&&e.get(t).references++}}}(o,[...n,...r]),function(e,n){e.appendTable("Garbage Collection Memory","#C3FF9C",(()=>{const e=[];e.push(["OBJECT NAME","OBJECT TYPE","REFERENCE COUNT"]);for(const[t,a]of n)e.push([t,a.type,a.references.toString()]);return e}))}(e,o);const i=function(e){const n=[];for(const[t,a]of e)0==a.references&&n.push(t);return n}(o);return function(e,n){e.appendTable("Objects To Be Removed","#FFEF9D",(()=>{const e=[];for(const t of n)e.push([t]);return e}))}(e,i),function(e,n){const t=new Array(n.length);let r=0;for(const o of n)(!a.includes(o[0][0])||!e.includes(o[1][0]))&&(t[r++]=o);return t.slice(0,r)}(i,n)}},462:function(e,n,t){var a=this&&this.__createBinding||(Object.create?function(e,n,t,a){void 0===a&&(a=t),Object.defineProperty(e,a,{enumerable:!0,get:function(){return n[t]}})}:function(e,n,t,a){void 0===a&&(a=t),e[a]=n[t]}),r=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),o=this&&this.__exportStar||function(e,n){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(n,t)||a(n,e,t)},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&a(n,e,t);return r(n,e),n};Object.defineProperty(n,"__esModule",{value:!0}),n.IDFConstants=void 0,o(t(73),n),o(t(345),n),n.IDFConstants=i(t(482)),o(t(327),n)},713:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.parseIDF=void 0;const t=/^([^!]+)(!-.+)?$/,a=/(,|;)$/,r=/(?:^\!)|(?:^\s*$)/;function o(e){const n=e.match(t);return[n[1].trim(),(n[2]||"").trim()]}n.parseIDF=function(e,n){const t=new Array;let i="",s=[];for(const n of function*(e){let n=new Array,t=!1;for(const a of e)"\n"===a||"\r"===a?(t||(yield n.join("")),t=!0,n=[]):(t=!1,n.push(a));return n.join("")}(e)){const e=n.trim();if(!r.test(e)){const[n,r]=o(e),c=n.endsWith(";"),l=n.replace(a,"").split(",");""!==r&&(i=r);const u=l.length;if(1===u)s.push([l[0],i]);else for(let e=0;e<u;e++)s.push([l[e].trim(),`${""===i?"!-":i}    --- Part ${e+1} of ${u}`]);c&&(t.push(s),i="",s=[])}}return n.appendText(`Parsed the IDF file of length ${e.length} characters.`),t}},506:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.serializeIDFDocument=n.C19_TEMPLATE_MATERIALS_HEADER=n.GENERATED_IDF_OBJECTS_HEADER=void 0;function t(e){const n=e.length,t=new Array(n);t[0]=`${e[0]}`;for(let r=1;r<n;r++)t[r]=a(e[r],r+1==n);return t.join("\n")}function a([e,n],t){const a=t?";":",";if(""===n)return"   "+e+a;const r=30-e.length-1;return"   "+e+a+(r>0?" ".repeat(r):"  ")+n}n.GENERATED_IDF_OBJECTS_HEADER="\n\n\n! ======================== IDF19 GENERATED OBJECTS ========================\n\n",n.C19_TEMPLATE_MATERIALS_HEADER="\n\n\n! ==================== IDF19 WINDOW TEMPLATE MATERIALS ====================\n\n",n.serializeIDFDocument=function(e,n){const a=e.length,r=new Array(a);for(let o=0;o<a;o++){const a=e[o];n.includes(a[0][0])||(r[o]=t(a))}return"\n"+r.join("\n\n")}},327:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0})},322:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Logger=void 0;const t=/\B(?=(\d{3})+(?!\d))/g;class a{#loggerIsOff;#logs;#headings;#headingIDCounter;constructor(e){this.#loggerIsOff=!e,this.#logs=[],this.#headings=[],this.#headingIDCounter=1}markSection(e){this.#headings.push(e);const n=`<hr /><h2 id="mark-${this.#headingIDCounter++}">${e}</h2>`;this.#logs.push(n)}appendText(e){if(this.#loggerIsOff)return;const n=`<div class="log">${a.encodeToHTML(e)}</div>`;this.#logs.push(n)}appendTable(e,n,t){if(this.#loggerIsOff)return;const r=t(),o=`<thead>\n                        <tr>\n                            <th colspan="${r[0].length}">${a.encodeToHTML(e)}</th>\n                        </tr>\n                    </thead>`,i=new Array;for(const e of r){const n=new Array;for(const t of e)n.push(`<td>${a.encodeToHTML(t)}</td>`);i.push(`<tr>${n.join("")}</tr>`)}const s=`<div class="log">\n                        <table style="background-color: ${n}">${o}<tbody>${i.join("\n")}</tbody></table>\n                    </div>`;this.#logs.push(s)}appendLine(){this.#logs.push("<hr />")}static encodeToHTML(e){return e.trim().replace(/[<>\n]|(?:&\B)/g,(e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case"\n":return"</br>";default:throw new Error("Core Error: Bad Regular Expression")}}))}get tableOfContents(){let e=1;return`\n                    <div class="table-of-contents">\n                        Jump To:\n                        <ul>${this.#headings.map((n=>`<li><a href="#mark-${e++}">${n}</a></li>`)).join("")}</ul>\n                    </div>\n                `}renderLogsHTML(){return this.#loggerIsOff?"":`\n                    <!DOCTYPE html>\n                    <html lang="en">\n                        <head>\n                            <meta charset="UTF-8">\n                            <meta http-equiv="X-UA-Compatible" content="IE=edge">\n                            <meta name="viewport" content="width=device-width, initial-scale=1.0">\n                            <title>IDF19 Logs</title>\n                            <style>\n                                html {\n                                    background-color:   #FFFCF2;\n                                    font-size:          10pt;\n                                    font-family:        Monaco, Menlo, "Source Code Pro", "Courier New", monospace;\n                                }\n                                body {\n                                    padding:        60pt;\n                                    max-width:      -moz-fit-content;\n                                    max-width:      fit-content;\n                                    margin:         auto;\n                                }\n\n                                table, td {\n                                    border-collapse:    collapse;\n                                    border:             1px solid black;\n                                }\n\n                                thead {\n                                    background-color:   black;\n                                    color:              white;\n                                }\n\n                                th, td {\n                                    padding:        5pt 10pt 5pt 10pt;\n                                    font-weight:    normal;\n                                }\n\n                                img {\n                                    margin-top: 70pt;\n                                }\n\n                                a {\n                                    color: black;\n                                }\n\n                                .table-of-contents {\n                                    padding:            10pt;\n                                    border:             1px solid black;\n                                    margin-bottom:      40pt;\n                                    max-width:          -moz-fit-content;\n                                    max-width:          fit-content;\n                                    background-color:   #FFC39C;\n                                }\n\n                                .table-of-contents a {\n                                    display: block;\n                                    margin-top: 3pt;\n                                }\n\n                                ul {\n                                    padding-left: 20pt;\n                                }\n\n                                @media (prefers-color-scheme: dark) {\n                                    html {\n                                        background-color:   black;\n                                        color:              white;\n                                    }\n\n                                    .table-of-contents {\n                                        color:  black;\n                                    }\n\n                                    tbody tr {\n                                        color:  black;\n                                    }\n\n                                    thead {\n                                        background-color:   black;\n                                    }\n\n                                    img {\n                                        filter: invert(100%);\n                                    }\n                                }\n                            </style>\n                        </head>\n                        <body>\n                            ${this.tableOfContents}\n                            ${this.#logs.join("<br><br>")}\n                            <center>\n                                <a href="https://kary.us/">\n                                    <img src="https://user-images.githubusercontent.com/2157285/129073689-4d48b4f2-6b04-4665-91bc-896eb1d13340.png" width="70">\n                                </a>\n                            </center>\n                        </body>\n                    </html>\n                `}formatNumber(e){return e.toString().replace(t,",")}}n.Logger=a},752:(e,n,t)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.transformIDF=void 0;const a=t(322),r=t(462),o=t(625);n.transformIDF=function(e){const n=new a.Logger(e.outputLog),t=new r.IDFDocument(e.idf,n),i={ec:e.ec,group:e.buildingGroupType,removeGlazing:e.removeGlazing,energyNeed:e.energyNeed};o.compileToReferenceIDF(t,i,n);const s=t.serializedIDF;return e.garbageCollection&&t.garbageCollect(),e.outputLog?n.renderLogsHTML():s}}},n={};function t(a){var r=n[a];if(void 0!==r)return r.exports;var o=n[a]={exports:{}};return e[a].call(o.exports,o,o.exports,t),o.exports}var a={};(()=>{var e=a;Object.defineProperty(e,"__esModule",{value:!0});const n=t(752);var r="";function o(){try{if(""===r)throw"An IDF file should be selected";i(!1);const t=function(){const e=s("energy-need"),n=s("ec"),t=parseInt(s("group")),a="Remove"===s("glazing");return{idf:r,ec:n,buildingGroupType:t,removeGlazing:a,energyNeed:e,garbageCollection:!1,outputLog:!0}}(),a=n.transformIDF(t);t.outputLog=!1;const o=n.transformIDF(t);e=a,document.getElementById("result-view").src=`data:text/html;charset=utf-8,${encodeURIComponent(e)}`,function(e){const n=(new Date).toLocaleString().replace(/[\/\.:]/g,"-");var t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download",`Compiled Reference (${n}).19.idf`),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}(o),i(!0)}catch(e){i(!0),"string"==typeof e?alert(e):e instanceof Error?alert(e.message):alert("Unknown Error. Check logs."),console.error(e)}var e}function i(e){document.getElementById("compiling-modal").hidden=e}function s(e){return document.getElementById(e).value}window.onload=function(){document.getElementById("idf").addEventListener("change",(function(){var e=this.files;if(0!==e.length){var n=new FileReader;n.onload=function(e){e&&e.target&&(r=e.target.result)},n.readAsText(e[0])}})),document.getElementById("compute-button").addEventListener("click",o)}})();var r=exports;for(var o in a)r[o]=a[o];a.__esModule&&Object.defineProperty(r,"__esModule",{value:!0})})();